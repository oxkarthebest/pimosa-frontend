<!-- Section Title -->
<h2 class="section-title">
  <span class="section-icon mr-2"><i class="fas fa-plus"></i></span>
  <span>Registrar Proyecto</span>
</h2>

<!-- Alert Messages -->
<div class="alert alert-success alert-dismissible fade show" role="alert" *ngIf="successAlertMessage">
  {{successAlertMessage}}
  <button type="button" class="close" aria-label="Close" (click)="closeSuccessAlert()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<div class="alert alert-danger alert-dismissible fade show" role="alert" *ngIf="errorAlertMessage">
  {{errorAlertMessage}}
  <button type="button" class="close" aria-label="Close" (click)="closeErrorAlert()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<form [formGroup]="newProjectForm" (submit)="submitNewProjectForm()">
  <div class="form-row">
    <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
      <!-- Name Input -->
      <div class="form-group">
        <label for="nameInput">
          <span class="form-label">Nombre del Proyecto</span>
        </label>
        <input type="text" class="form-control" id="nameInput" formControlName="name"
          [ngClass]="(newProjectForm.get('name').invalid && (newProjectForm.get('name').touched || newProjectForm.get('name').dirty) ) ? 'input-invalid' : 'input-default'" />
        <!-- Helper Text -->
        <div
          *ngIf="(newProjectForm.get('name').valid) || (newProjectForm.get('name').invalid && (newProjectForm.get('name').pristine && newProjectForm.get('name').untouched) )">
          <small id="nameInputHelp" class="form-text text-muted">
            Ingrese el nombre del proyecto.
          </small>
        </div>
        <!-- Error Handling -->
        <div
          *ngIf="newProjectForm.get('name').invalid && (newProjectForm.get('name').dirty || newProjectForm.get('name').touched)">
          <small id="nameInputError" class="form-text text-danger">
            <div *ngIf="newProjectForm.get('name').hasError('required')">
              Es necesario ingresar el nombre del proyecto.
            </div>
            <div *ngIf="newProjectForm.get('name').hasError('maxlength')">
              El nombre del proyecto no puede contener más de 254 caracteres.
            </div>
            <div *ngIf="newProjectForm.get('name').hasError('minlength')">
              El nombre del proyecto debe contener al menos 2 caracteres.
            </div>
          </small>
        </div>
      </div>
    </div>
  </div>

  <div class="form-row">
    <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
      <!-- Code Input -->
      <div class="form-group">
        <label for="codeInput">
          <span class="form-label">Código de Proyecto</span>
        </label>
        <input type="text" class="form-control" id="codeInput" formControlName="code"
          [ngClass]="(newProjectForm.get('code').invalid && (newProjectForm.get('code').touched || newProjectForm.get('code').dirty) ) ? 'input-invalid' : 'input-default'" />
        <!-- Helper Text -->
        <div
          *ngIf="(newProjectForm.get('code').valid) || (newProjectForm.get('code').invalid && (newProjectForm.get('code').pristine && newProjectForm.get('code').untouched) )">
          <small id="codeInputHelp" class="form-text text-muted">
            Ingrese el código de proyecto.
          </small>
        </div>
        <!-- Error Handling -->
        <div
          *ngIf="newProjectForm.get('code').invalid && (newProjectForm.get('code').dirty || newProjectForm.get('code').touched)">
          <small id="codeInputError" class="form-text text-danger">
            <div *ngIf="newProjectForm.get('code').hasError('required')">
              Es necesario ingresar el código del proyecto.
            </div>
            <div *ngIf="newProjectForm.get('code').hasError('maxlength')">
              El código del proyecto no puede contener más de 124 caracteres.
            </div>
            <div *ngIf="newProjectForm.get('code').hasError('minlength')">
              El código del proyecto debe contener al menos 2 caracteres.
            </div>
          </small>
        </div>
      </div>
    </div>
    <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
      <!-- Purchase Order Input -->
      <div class="form-group">
        <label for="purchaseOrderInput">
          <span class="form-label">Orden de Compra</span>
        </label>
        <input type="text" class="form-control" id="purchaseOrderInput" formControlName="purchaseOrder"
          [ngClass]="(newProjectForm.get('purchaseOrder').invalid && (newProjectForm.get('purchaseOrder').touched || newProjectForm.get('purchaseOrder').dirty) ) ? 'input-invalid' : 'input-default'" />
        <!-- Helper Text -->
        <div
          *ngIf="(newProjectForm.get('purchaseOrder').valid) || (newProjectForm.get('purchaseOrder').invalid && (newProjectForm.get('purchaseOrder').pristine && newProjectForm.get('purchaseOrder').untouched) )">
          <small id="purchaseOrderInputHelp" class="form-text text-muted">
            Ingrese la orden de compra.
          </small>
        </div>
        <!-- Error Handling -->
        <div
          *ngIf="newProjectForm.get('purchaseOrder').invalid && (newProjectForm.get('purchaseOrder').dirty || newProjectForm.get('purchaseOrder').touched)">
          <small id="purchaseOrderInputError" class="form-text text-danger">
            <div *ngIf="newProjectForm.get('purchaseOrder').hasError('required')">
              Es necesario ingresar el la orden de compra del proyecto.
            </div>
            <div *ngIf="newProjectForm.get('purchaseOrder').hasError('maxlength')">
              La la orden de compra del proyecto no puede contener más de 254 caracteres.
            </div>
            <div *ngIf="newProjectForm.get('purchaseOrder').hasError('minlength')">
              La la orden de compra del proyecto debe contener al menos 2 caracteres.
            </div>
          </small>
        </div>
      </div>
    </div>
  </div>

  <div class="form-row">
    <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
      <!-- Description Input -->
      <div class="form-group">
        <label for="descriptionInput">
          <span class="form-label">Descripción del Proyecto</span>
        </label>
        <textarea type="text" class="form-control" id="descriptionInput" formControlName="description"
          [ngClass]="(newProjectForm.get('description').invalid && (newProjectForm.get('description').touched || newProjectForm.get('description').dirty) ) ? 'input-invalid' : 'input-default'">
        </textarea>
        <!-- Helper Text -->
        <div
          *ngIf="(newProjectForm.get('description').valid) || (newProjectForm.get('description').invalid && (newProjectForm.get('description').pristine && newProjectForm.get('description').untouched) )">
          <small id="descriptionInputHelp" class="form-text text-muted">
            Ingrese la descripción del proyecto.
          </small>
        </div>
        <!-- Error Handling -->
        <div
          *ngIf="newProjectForm.get('description').invalid && (newProjectForm.get('description').dirty || newProjectForm.get('description').touched)">
          <small id="descriptionInputError" class="form-text text-danger">
            <div *ngIf="newProjectForm.get('description').hasError('maxlength')">
              La descripción del proyecto no puede contener más de 400 caracteres.
            </div>
            <div *ngIf="newProjectForm.get('description').hasError('minlength')">
              La descripción del proyecto debe contener al menos 2 caracteres.
            </div>
          </small>
        </div>
      </div>
    </div>
  </div>

  <div class="form-row">
    <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
      <!-- Industry Input -->
      <label for="industry">
        <span class="form-label">Industria</span>
      </label>
      <select class="form-control input-default" id="industry" formControlName="industry"
        aria-describedby="industryHelp">
        <option selected disabled value="">Seleccionar</option>
        <option *ngFor="let industry of industryList" value={{industry.pk}}>
          {{industry.name}}</option>
      </select>
      <small id="industryHelp" class="form-text text-muted">
        Seleccione la industria.
      </small>
    </div>
  </div>

  <div class="form-row">
    <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
      <!-- Start Date Input -->
      <div class="form-group">
        <label for="startDateInput">
          <span class="form-label">Fecha de Inicio</span>
        </label>
        <input type="date" class="form-control" id="startDateInput" formControlName="startDate"
          [ngClass]="(newProjectForm.get('startDate').invalid && (newProjectForm.get('startDate').touched || newProjectForm.get('startDate').dirty) ) ? 'input-invalid' : 'input-default'" />
        <!-- Helper Text -->
        <div
          *ngIf="(newProjectForm.get('startDate').valid) || (newProjectForm.get('startDate').invalid && (newProjectForm.get('startDate').pristine && newProjectForm.get('startDate').untouched) )">
          <small id="startDateInputHelp" class="form-text text-muted">
            Ingrese la fecha de inicio.
          </small>
        </div>
        <!-- Error Handling -->
        <div
          *ngIf="newProjectForm.get('startDate').invalid && (newProjectForm.get('startDate').dirty || newProjectForm.get('startDate').touched)">
          <small id="startDateInputError" class="form-text text-danger">
            <div *ngIf="newProjectForm.get('startDate').hasError('required')">
              Es necesario ingresar la fecha de inicio del proyecto.
            </div>
          </small>
        </div>
      </div>
    </div>
    <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
      <!-- Planned End Date Input -->
      <div class="form-group">
        <label for="plannedEndDateInput">
          <span class="form-label">Fecha de Término</span>
        </label>
        <input type="date" class="form-control" id="plannedEndDateInput" formControlName="plannedEndDate"
          [ngClass]="(newProjectForm.get('plannedEndDate').invalid && (newProjectForm.get('plannedEndDate').touched || newProjectForm.get('plannedEndDate').dirty) ) ? 'input-invalid' : 'input-default'" />
        <!-- Helper Text -->
        <div
          *ngIf="(newProjectForm.get('plannedEndDate').valid) || (newProjectForm.get('plannedEndDate').invalid && (newProjectForm.get('plannedEndDate').pristine && newProjectForm.get('plannedEndDate').untouched) )">
          <small id="plannedEndDateInputHelp" class="form-text text-muted">
            Ingrese la fecha programada de término.
          </small>
        </div>
        <!-- Error Handling -->
        <div
          *ngIf="newProjectForm.get('plannedEndDate').invalid && (newProjectForm.get('plannedEndDate').dirty || newProjectForm.get('plannedEndDate').touched)">
          <small id="plannedEndDateInputError" class="form-text text-danger">
            <div *ngIf="newProjectForm.get('plannedEndDate').hasError('required')">
              Es necesario ingresar el la fecha programada de término.
            </div>
          </small>
        </div>
      </div>
    </div>
  </div>

  <div class="form-row">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 text-center">
      <!-- Submit Form Button -->
      <button type="submit" class="btn btn-block primary-button" [disabled]="!newProjectForm.valid">Crear</button>
    </div>
  </div>
</form>
